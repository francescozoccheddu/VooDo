<Window
    x:Class="VooDo.Testbench.Desktop.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:tb="using:VooDo.Testbench.Desktop"
    xmlns:voodo="using:VooDo.WinUI.Xaml">

    <Grid Background="LightGray">

        <Grid.Resources>
            <ThemeShadow x:Name="m_shadow" />
        </Grid.Resources>

        <Grid>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid
                x:Name="m_header"
                Grid.Row="0"
                Padding="10"
                Background="Gray">

                <voodo:Object.Binding>
                    <voodo:Property>
                        global bool isHovered;
                        isHovered |= this.PointerEntered;
                        isHovered &amp;= !this.PointerExited;
                        bool hasScrolled = root.m_gridView.ScrollViewer.VerticalOffset >= 20;
                        this.Height = glob Smooth(isHovered ? 100 : (hasScrolled ? 20 : 50));
                    </voodo:Property>
                </voodo:Object.Binding>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="m_headerText" VerticalAlignment="Center">
                    Header
                </TextBlock>

            </Grid>

            <tb:CustomGridView
                x:Name="m_gridView"
                Grid.Row="1"
                Padding="10"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                SelectionMode="None">

                <GridView.ItemTemplate>
                    <DataTemplate x:DataType="tb:Item">
                        <Border
                            Width="150"
                            Height="200"
                            Margin="10">

                            <Grid
                                Width="140"
                                Height="190"
                                Background="White"
                                CornerRadius="5"
                                Shadow="{StaticResource m_shadow}">

                                <voodo:Object.Binding>
                                    <voodo:Property>
                                        global double focus = 0;
                                        if (this.PointerEntered)
                                        $focus = Smooth(1);
                                        if (this.PointerExited)
                                        $focus = Smooth(0);
                                        double margin = Lerp(5, 0, focus);
                                        FrameworkElement parent = (FrameworkElement) this.Parent;
                                        this.Width = parent.Width - margin;
                                        this.Height = parent.Height - margin;
                                        this.Opacity = Lerp(0.75, 1, focus);
                                        this.CornerRadius = new(Lerp(5, 2, focus));
                                    </voodo:Property>
                                </voodo:Object.Binding>

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <TextBlock Text="{x:Bind Title}" />

                            </Grid>

                        </Border>
                    </DataTemplate>
                </GridView.ItemTemplate>

            </tb:CustomGridView>

        </Grid>

        <StackPanel
            Margin="20"
            HorizontalAlignment="Left"
            VerticalAlignment="Bottom"
            Orientation="Vertical"
            Spacing="10">

            <Border
                x:Name="m_frameButton"
                Width="60"
                Height="60"
                HorizontalAlignment="Left"
                Background="BlueViolet"
                CornerRadius="10"
                Shadow="{StaticResource m_shadow}">

                <voodo:Object.Binding>
                    <voodo:Property>
                        global double focus = 0;
                        global double swype = 0;
                        if (this.PointerEntered)
                        {
                        $focus = Spring(1);
                        $swype = Smooth(1);
                        }
                        if (this.PointerExited)
                        {
                        $focus = Smooth(0);
                        $swype = Smooth(0);
                        }
                        this.Width = Lerp(60, 300, focus);
                        this.Height = Lerp(60, 400, focus);
                        this.CornerRadius = new(Lerp(30, 10, focus));
                        root.m_frameButtonIcon.Translation = new((float) Lerp(0, -60, swype), 0, 0);
                        root.m_frameButtonTextBox.Margin = new((float) Lerp(60, 0, swype), 0, 0, 0);
                    </voodo:Property>
                </voodo:Object.Binding>

                <Grid>

                    <Grid
                        x:Name="m_frameButtonContent"
                        Height="400"
                        Padding="10"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Bottom"
                        IsHitTestVisible="False"
                        RowSpacing="10">

                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="40" />
                        </Grid.RowDefinitions>

                        <TextBox
                            x:Name="m_frameButtonTextBox"
                            Grid.Row="1"
                            Margin="60,0,0,0"
                            HorizontalAlignment="Stretch"
                            CornerRadius="10"
                            PlaceholderText="Type your message here" />

                        <StackPanel
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Bottom"
                            Orientation="Vertical"
                            Spacing="10">

                            <Border
                                Width="80"
                                Height="20"
                                voodo:Object.Binding="{voodo:Property Path=FrameButtonItem.voodo}"
                                Background="Violet"
                                CornerRadius="10">

                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontSize="12"
                                    Text="Wednesday" />

                            </Border>

                            <Border
                                MaxWidth="240"
                                Padding="10"
                                HorizontalAlignment="Left"
                                voodo:Object.Binding="{voodo:Property Path=FrameButtonItem.voodo}"
                                Background="Violet"
                                CornerRadius="0,10,10,10">

                                <StackPanel Orientation="Vertical">
                                    <TextBlock
                                        FontSize="12"
                                        FontWeight="Bold"
                                        Opacity="0.7"
                                        Text="Redrick Schuhart" />
                                    <TextBlock Text="Who'll be the third?" />
                                </StackPanel>

                            </Border>

                            <Border
                                MaxWidth="240"
                                Padding="10"
                                HorizontalAlignment="Right"
                                voodo:Object.Binding="{voodo:Property Path=FrameButtonItem.voodo}"
                                Background="PaleVioletRed"
                                CornerRadius="10,10,0,10">

                                <StackPanel Orientation="Vertical">
                                    <TextBlock
                                        HorizontalAlignment="Right"
                                        FontSize="12"
                                        FontWeight="Bold"
                                        Opacity="0.7"
                                        Text="You" />
                                    <TextBlock HorizontalAlignment="Right" Text="What do we need a third for?" />
                                </StackPanel>

                            </Border>

                            <StackPanel Orientation="Vertical" Spacing="5">

                                <Border
                                    MaxWidth="240"
                                    Padding="10"
                                    HorizontalAlignment="Left"
                                    voodo:Object.Binding="{voodo:Property Path=FrameButtonItem.voodo}"
                                    Background="Violet"
                                    CornerRadius="0,10,2,2">

                                    <StackPanel Orientation="Vertical">
                                        <TextBlock
                                            FontSize="12"
                                            FontWeight="Bold"
                                            Opacity="0.7"
                                            Text="Redrick Schuhart" />
                                        <TextBlock Text="Oh no!" />
                                    </StackPanel>

                                </Border>

                                <Border
                                    MaxWidth="240"
                                    Padding="10"
                                    HorizontalAlignment="Left"
                                    voodo:Object.Binding="{voodo:Property Path=FrameButtonItem.voodo}"
                                    Background="Violet"
                                    CornerRadius="2,2,10,10">

                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Text="This is no picnic with ladies." />
                                    </StackPanel>

                                </Border>

                            </StackPanel>

                        </StackPanel>

                    </Grid>

                    <Border
                        x:Name="m_frameButtonIcon"
                        Width="60"
                        Height="60"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Bottom">

                        <SymbolIcon Symbol="Message" />

                    </Border>

                </Grid>

            </Border>

            <Border
                x:Name="m_snakeButton"
                Width="60"
                Height="60"
                HorizontalAlignment="Left"
                Background="BlueViolet"
                CornerRadius="10"
                Shadow="{StaticResource m_shadow}">

                <voodo:Object.Binding>
                    <voodo:Property>
                        global double focus = 0;
                        if (this.PointerEntered)
                        $focus = Spring(1);
                        if (this.PointerExited)
                        $focus = Smooth(0);
                        this.Width = Lerp(60, root.m_snakeButtonContent.Width, focus);
                        this.CornerRadius = new(Lerp(30, 10, focus));
                    </voodo:Property>
                </voodo:Object.Binding>

                <Grid
                    x:Name="m_snakeButtonContent"
                    Width="300"
                    Height="60"
                    HorizontalAlignment="Left"
                    IsHitTestVisible="False">

                    <Grid.Resources>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                        </Style>
                    </Grid.Resources>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="60" />
                        <ColumnDefinition Width="60" />
                        <ColumnDefinition Width="60" />
                        <ColumnDefinition Width="60" />
                        <ColumnDefinition Width="60" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="A" />
                    <TextBlock
                        Grid.Column="1"
                        voodo:Object.Binding="{voodo:Property Path=SnakeButtonItem.voodo}"
                        Text="B" />
                    <TextBlock
                        Grid.Column="2"
                        voodo:Object.Binding="{voodo:Property Path=SnakeButtonItem.voodo}"
                        Text="C" />
                    <TextBlock
                        Grid.Column="3"
                        voodo:Object.Binding="{voodo:Property Path=SnakeButtonItem.voodo}"
                        Text="D" />
                    <TextBlock
                        Grid.Column="4"
                        voodo:Object.Binding="{voodo:Property Path=SnakeButtonItem.voodo}"
                        Text="E" />

                </Grid>

            </Border>

        </StackPanel>

    </Grid>

</Window>
